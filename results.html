<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        
        <meta name="viewport" content="width=320; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
        
        <style type="text/css">
            .demo-pricing {
                margin-top: 10px;
                margin-right: 10px;
                padding: 14px 26px;
                font-size: 14px;
                line-height: 100%;
                text-shadow: 0 1px rgba(0, 0, 0, 0.4);
                color: #fff;
                display: inline-block;
                vertical-align: middle;
                text-align: center;
                cursor: pointer;
                font-weight: bold;
                transition: background 0.1s ease-in-out;
                -webkit-transition: background 0.1s ease-in-out;
                -moz-transition: background 0.1s ease-in-out;
                -ms-transition: background 0.1s ease-in-out;
                -o-transition: background 0.1s ease-in-out;
                text-shadow: 0 1px rgba(0, 0, 0, 0.3);
                color: #fff;
                -webkit-border-radius: 3px;
                -moz-border-radius: 3px;
                border-radius: 0px;
                font-family: 'Helvetica Neue', Helvetica, sans-serif;
            }
        
        .demo-pricing:active {
            padding-top: 15px;
            margin-bottom: -1px;
        }
        
        .demo-pricing, .demo-pricing:hover, .demo-pricing:active {
            outline: 0 none;
            text-decoration: none;
            color: #fff;
        }
        
        .demo-pricing-1 {
            background-color: #660000;
            box-shadow: 0px 0px 0px 0px #3293ba;
        }
        
        .demo-pricing-1:hover {
            background-color: #1baae3;
        }
        
        .demo-pricing-1:active {
            box-shadow: 0px 1px 0px 0px #3293ba;
        }
        
        
        .demo-pricing-2 {
            background-color: #f06060;
            box-shadow: 0px 3px 0px 0px #cd1313;
        }
        
        .demo-pricing-2:hover {
            background-color: #ed4444;
        }
        
        .demo-pricing-2:active {
            box-shadow: 0px 1px 0px 0px #cd1313;
        }
        
        .demo-pricing-3 {
            background-color: #ff6a80;
            box-shadow: 0px 3px 0px 0px #da0020;
        }
        
        .demo-pricing-3:hover {
            background-color: #ff566f;
        }
        
        .demo-pricing-3:active {
            box-shadow: 0px 1px 0px 0px #da0020;
        }
        </style>
        <style type="text/css">
            .style1 {
                width: 70px;
            }
        
        .style2 {
            width: 106px;
        }
        
        #Text1 {
            width: 82px;
        }
        
        #Select2 {
            width: 106px;
        }
        
        #Select3 {
            width: 106px;
        }
        
        #Select6 {
            width: 109px;
        }
        
        #Select1 {
            width: 104px;
        }
        
        #Select7 {
            width: 108px;
        }
        
        #Text2 {
            height: 24px;
            width: 141px;
        }
        
        #Text3 {
            width: 34px;
        }
        
        #Text4 {
            width: 55px;
        }
        
        .style3 {
            width: 86px;
        }
        
        #TextArea1 {
            height: 46px;
            width: 180px;
        }
        
        .style4 {
            width: 204px;
        }
        
        .style5 {
            width: 90px;
        }
        
        .style6 {
            width: 70px;
            height: 26px;
        }
        
        .style7 {
            width: 90px;
            height: 26px;
        }
        
        .style9 {
            width: 107px;
            height: 26px;
        }
        
        .style10 {
            width: 107px;
        }
        
        .style11 {
            width: 121px;
        }
        
        #Text1 {
            width: 89px;
        }
        
        #Button1 {
            width: 110px;
        }
        
        #Submit1 {
            width: 103px;
        }
        
        .button {
            border-top: 1px solid #96d1f8;
            background: #65a9d7;
            background: -webkit-gradient(linear, left top, left bottom, from(#4681a8), to(#65a9d7));
            background: -webkit-linear-gradient(top, #4681a8, #65a9d7);
            background: -moz-linear-gradient(top, #4681a8, #65a9d7);
            background: -ms-linear-gradient(top, #4681a8, #65a9d7);
            background: -o-linear-gradient(top, #4681a8, #65a9d7);
            padding: 5px 10px;
            -webkit-border-radius: 6px;
            -moz-border-radius: 6px;
            border-radius: 6px;
            -webkit-box-shadow: rgba(0,0,0,1) 0 1px 0;
            -moz-box-shadow: rgba(0,0,0,1) 0 1px 0;
            box-shadow: rgba(0,0,0,1) 0 1px 0;
            text-shadow: rgba(0,0,0,.4) 0 1px 0;
            color: white;
            font-size: 14px;
            font-family: Georgia, Serif;
            text-decoration: none;
            vertical-align: middle;
        }
        
        
        
        #Text2 {
            width: 89px;
        }
        </style>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script language="javascript" type="text/javascript">
            
            var divs = 1;
            
            
            //var phonetype = "%phonetype%";
            var mailtoLink1
            
            var defaults = false;
            var hasData = true;
            function checkData() {
                hasData = true;
                //alert('data');
            }
        
        
        function testConnection() {
            //  testdatadiv.innerHTML +=
            //  '<img id="testImage" style="display: none;" ' +
            //  'src="http://68.14.234.84/testconnection.gif?' + Math.random() + '" ' +
            //  'onload="checkData();">';
            checkData();
            //startTime = (new Date()).getTime() ;
            //download.src = imageAddr ;
        }
        
        var Base64 = {
            
            // private property
            _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
            
            // public method for encoding
            encode: function (input) {
                var output = "";
                var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
                var i = 0;
                
                input = Base64._utf8_encode(input);
                
                while (i < input.length) {
                    
                    chr1 = input.charCodeAt(i++);
                    chr2 = input.charCodeAt(i++);
                    chr3 = input.charCodeAt(i++);
                    
                    enc1 = chr1 >> 2;
                    enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
                    enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
                    enc4 = chr3 & 63;
                    
                    if (isNaN(chr2)) {
                        enc3 = enc4 = 64;
                    } else if (isNaN(chr3)) {
                        enc4 = 64;
                    }
                    
                    output = output +
                    this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +
                    this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);
                    
                }
                
                return output;
            },
            
            // public method for decoding
            decode: function (input) {
                var output = "";
                var chr1, chr2, chr3;
                var enc1, enc2, enc3, enc4;
                var i = 0;
                
                input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");
                
                while (i < input.length) {
                    
                    enc1 = this._keyStr.indexOf(input.charAt(i++));
                    enc2 = this._keyStr.indexOf(input.charAt(i++));
                    enc3 = this._keyStr.indexOf(input.charAt(i++));
                    enc4 = this._keyStr.indexOf(input.charAt(i++));
                    
                    chr1 = (enc1 << 2) | (enc2 >> 4);
                    chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
                    chr3 = ((enc3 & 3) << 6) | enc4;
                    
                    output = output + String.fromCharCode(chr1);
                    
                    if (enc3 != 64) {
                        output = output + String.fromCharCode(chr2);
                    }
                    if (enc4 != 64) {
                        output = output + String.fromCharCode(chr3);
                    }
                    
                }
                
                output = Base64._utf8_decode(output);
                
                return output;
                
            },
            
            // private method for UTF-8 encoding
            _utf8_encode: function (string) {
                string = string.replace(/\r\n/g, "\n");
                var utftext = "";
                
                for (var n = 0; n < string.length; n++) {
                    
                    var c = string.charCodeAt(n);
                    
                    if (c < 128) {
                        utftext += String.fromCharCode(c);
                    }
                    else if ((c > 127) && (c < 2048)) {
                        utftext += String.fromCharCode((c >> 6) | 192);
                        utftext += String.fromCharCode((c & 63) | 128);
                    }
                    else {
                        utftext += String.fromCharCode((c >> 12) | 224);
                        utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                        utftext += String.fromCharCode((c & 63) | 128);
                    }
                    
                }
                
                return utftext;
            },
            
            // private method for UTF-8 decoding
            _utf8_decode: function (utftext) {
                var string = "";
                var i = 0;
                var c = c1 = c2 = 0;
                
                while (i < utftext.length) {
                    
                    c = utftext.charCodeAt(i);
                    
                    if (c < 128) {
                        string += String.fromCharCode(c);
                        i++;
                    }
                    else if ((c > 191) && (c < 224)) {
                        c2 = utftext.charCodeAt(i + 1);
                        string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));
                        i += 2;
                    }
                    else {
                        c2 = utftext.charCodeAt(i + 1);
                        c3 = utftext.charCodeAt(i + 2);
                        string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
                        i += 3;
                    }
                    
                }
                
                return string;
            }
            
        }
        
        
        function addSimpleEmailAddressesSend() {
            document.getElementById('sendButton').disabled = true;
            //alert('test');
            var online = hasData;
            var print1;
            
            
            var startDate = document.getElementById('TimeIn');
            var AccountNumber = document.getElementById('AccountNumber');
            var email = "bulwarkrouteresults@gmail.com";
            var Route_Id = document.getElementById('Route_Id');
            var hr_emp_id = document.getElementById('hr_emp_id');
            var subject = "Results:" + Route_Id.value;
            
            
            
            var Invoice = document.getElementById('Invoice');
            
            
            var ServiceTypeCode = document.getElementById('servicetypecode');
            var Result = document.getElementById('Result');
            var paymenttype = document.getElementById('paymenttype');
            var Check = document.getElementById('Check');
            var paymentAmount = document.getElementById('paymentamount');
            var Comments = document.getElementById('Comments');
            
            var CustName = document.getElementById('CustomerName');
            
            var addr = document.getElementById('Address');
            var citystate = document.getElementById('CityState');
            var phone = document.getElementById('Phone1');
            var preBal = document.getElementById('PrevBal');
            var charge = document.getElementById('Charge');
            
            
            
            var body_message = Route_Id.value + ":" + AccountNumber.value + ":" + hr_emp_id.value + ":" + Invoice.value + ":" + ServiceTypeCode.value + ":" + Result.value + ":" + paymenttype.value + ":" + Check.value + ":" + paymentAmount.value + ":" + Comments.value + ":" + startDate.value + ":" + Date() + ":";
            var mailto_link;
            
            
            
            if (Result.value == "Serviced") {
                
                if (Invoice.value == "") {
                    alert('You Must enter an invoice')
                    document.getElementById('sendButton').disabled = false;
                    return false;
                }
                
                
                var timePat = /^(\d{1,2}):(\d{2})(:(\d{2}))?(\s?(AM|am|PM|pm))?$/;
                var timeStr = startDate.value;
                
                if (timeStr.indexOf(":") != -1) {
                }
                else {
                    var i = timeStr.length;
                    if (i == 3) {
                        timeStr = timeStr.charAt(0) + ':' + timeStr.charAt(1) + timeStr.charAt(2);
                        //alert(timeStr);
                    }
                    if (i == 4) {
                        timeStr = timeStr.charAt(0) + timeStr.charAt(1) + ':' + timeStr.charAt(2) + timeStr.charAt(3);
                        //alert(timstr);
                    }
                }
                
                var matchArray = timeStr.match(timePat);
                if (matchArray == null) {
                    alert("Time is not in a valid format.");
                    document.getElementById('sendButton').disabled = false;
                    return false;
                }
                hour = matchArray[1];
                minute = matchArray[2];
                second = matchArray[4];
                
                if (second == "") { second = null; }
                
                
                if (hour < 0 || hour > 23) {
                    alert("Hour must be between 1 and 12. (or 0 and 23 for 24hr Format)");
                    document.getElementById('sendButton').disabled = false;
                    return false;
                }
                
                if (minute < 0 || minute > 59) {
                    alert("Minute must be between 0 and 59.");
                    document.getElementById('sendButton').disabled = false;
                    return false;
                }
                if (second != null && (second < 0 || second > 59)) {
                    alert("Second must be between 0 and 59.");
                    document.getElementById('sendButton').disabled = false;
                    return false;
                }
                
            }
            if (paymenttype.value != "") {
                if (paymentAmount.value == "") {
                    alert('You selected a payment type but no payment amount');
                    document.getElementById('sendButton').disabled = false;
                    return false;
                }
            }
            if (paymenttype.value == "Check") {
                if (Check.value == "") {
                    alert('You selected Check type but no Check Number');
                    document.getElementById('sendButton').disabled = false;
                    return false;
                }
            }
            
            
            
            var fChemical = divs - 1;
            
            
            
            
            
            for (i = 1; i <= divs - 1; i++) {
                var ammt = document.getElementById('amount' + i);
                if (ammt.value != "") {
                    
                    //var units = document.getElementById('units' + i);
                    var schem = document.getElementById('chemicals' + i);
                    var fchem = schem.options[schem.selectedIndex].text;
                    var sper = document.getElementById('dPercent' + i);
                    var fper = sper.options[sper.selectedIndex].text;
                    var ssite = document.getElementById('dSite' + i);
                    //var fsite = ssite.options[ssite.selectedIndex].text;
                    var ssiteD = document.getElementById('dSiteDetail' + i);
                    //var fsiteD = ssiteD.options[ssiteD.selectedIndex].text;
                    var ob = document.getElementById('dPests' + i);
                    
                    
                    if (fchem == "") {
                        alert('Please Select a Chemical');
                        return false;
                    }
                    
                    var selected = '';
                    var cnt = ob.options.length - 1
                    //    if (cnt <= 0) {
                    //        alert('Please Select a Pest for ' + fchem);
                    //       return false;
                    //  }
                    for (z = 0; z <= cnt; z++) {
                        if (ob.options[z].selected)
                        selected += ob.options[z].value + ',';
                    }
                    
                    var Siteselected = '';
                    var cnt = ssite.options.length - 1
                    //  if (cnt <= 0) {
                    //      alert('Please Select a Site for ' + fchem);
                    //      return false;
                    //  }
                    for (z = 0; z <= cnt; z++) {
                        if (ssite.options[z].selected)
                        Siteselected += ssite.options[z].value + ',';
                    }
                    var ticket = document.getElementById('ticketinfo' + i);
                    var unit = document.getElementById('units' + i);
                    
                    fChemical += '!' + fchem + '&' + fper + '&' + Siteselected + '&' + selected + '&' + ammt.value + '&' + unit.value + '&' + ticket.value;
                    
                }
            }
            
            
            
            var ServiceTypeCode = document.getElementById('servicetypecode');
            var Result = document.getElementById('Result');
            var paymenttype = document.getElementById('paymenttype');
            var Check = document.getElementById('Check');
            var paymentAmount = document.getElementById('paymentamount');
            var Comments = document.getElementById('Comments');
            
            var CustName = document.getElementById('CustomerName');
            
            var addr = document.getElementById('Address');
            var citystate = document.getElementById('CityState');
            var phone = document.getElementById('Phone1');
            var preBal = document.getElementById('PrevBal');
            var charge = document.getElementById('Charge');
            
            
            var techName = document.getElementById('techname').value;
            var licNum = document.getElementById('licNumber').value;
            var lat = document.getElementById('lat').value;
            var lon = document.getElementById('lon').value;
            var accuracy = document.getElementById('accuracy');
            var woi = document.getElementById('workorderitem_id');
            
            if (fChemical == 0) {
                fChemical = '';
                //alert(fChemical);
            }
            
            
            if (Result.value == "MissedO") {
                if (Comments.value.length < 5) {
                    
                    alert('Missed Other Requires a Reason in the Comments');
                    document.getElementById('sendButton').disabled = false;
                    return false;
                    
                }
                
            }
            
            
            if (hasData == true) {
                
                
                mailto_link = 'bulwarktw://?3?!https://www.bulwarktechnician.com/submitResults.aspx' + '?Invoice=' + Invoice.value + '&AccountNumber=' + AccountNumber.value + '&ResultSelect=' + Result.value + '&hr_emp_id=' + hr_emp_id.value + '&Amount=' + paymentAmount.value + '&Check=' + Check.value + '&Comments=BaseData' + Base64.encode(Comments.value) + '&Route_id=' + Route_Id.value + '&radPayment=' + paymenttype.value + '&timein=' + startDate.value + '&date=routedatestring&ticketData=BaseData' + Base64.encode(fChemical.replace("&", "?")) + '&techname=' + techName + '&licnum=' + licNum + '&workorderitem_id=' + woi.value;
                
                //alert(mailto_link);
            }
            else {
                
                //alert('No Data Connection Please Send the Generated Email');
                mailto_link = 'bulwarktw://?4?!https://www.bulwarktechnician.com/submitResults.aspx' + '?Invoice=' + Invoice.value + '&AccountNumber=' + AccountNumber.value + '&ResultSelect=' + Result.value + '&hr_emp_id=' + hr_emp_id.value + '&Amount=' + paymentAmount.value + '&Check=' + Check.value + '&Comments=BaseData' + Base64.encode(Comments.value) + '&Route_id=' + Route_Id.value + '&radPayment=' + paymenttype.value + '&timein=' + startDate.value + '&date=routedatestring&ticketData=BaseData' + Base64.encode(fChemical.replace("&", "?")) + '&techname=' + techName + '&licnum=' + licNum + '&workorderitem_id=' + woi.value;
            }
            
            // alert(mailto_link);
            window.open(mailto_link);
            //document.links[1].href = mailto_link;
            return false;
        }
        
        
        
        function addSimpleEmailAddresses() {
            
            var online = false;
            var print1
            
            
            var startDate = document.getElementById('TimeIn');
            var AccountNumber = document.getElementById('AccountNumber');
            var email = "bulwarkrouteresults@gmail.com";
            var Route_Id = document.getElementById('Route_Id');
            var hr_emp_id = document.getElementById('hr_emp_id');
            var subject = "Results:" + Route_Id.value;
            
            
            
            var Invoice = Route_Id.value;
            
            
            var ServiceTypeCode = document.getElementById('servicetypecode');
            var Result = document.getElementById('Result');
            var paymenttype = document.getElementById('paymenttype');
            var Check = document.getElementById('Check');
            var paymentAmount = document.getElementById('paymentamount');
            var Comments = document.getElementById('Comments');
            
            var CustName = document.getElementById('CustomerName');
            
            var addr = document.getElementById('Address');
            var citystate = document.getElementById('CityState');
            var phone = document.getElementById('Phone1');
            var preBal = document.getElementById('PrevBal');
            var charge = document.getElementById('Charge');
            
            
            
            var body_message = Route_Id.value + ":" + AccountNumber.value + ":" + hr_emp_id.value + ":" + Invoice.value + ":" + ServiceTypeCode.value + ":" + Result.value + ":" + paymenttype.value + ":" + Check.value + ":" + paymentAmount.value + ":" + Comments.value + ":" + startDate.value + ":" + Date() + ":";
            var mailto_link;
            
            
            
            if (Result.value == "Serviced") {
                
                if (Invoice.value == "") {
                    alert('You Must enter an invoice')
                    return false;
                }
                
                
                var timePat = /^(\d{1,2}):(\d{2})(:(\d{2}))?(\s?(AM|am|PM|pm))?$/;
                var timeStr = startDate.value;
                
                if (timeStr.indexOf(":") != -1) {
                }
                else {
                    var i = timeStr.length;
                    if (i == 3) {
                        timeStr = timeStr.charAt(0) + ':' + timeStr.charAt(1) + timeStr.charAt(2);
                        //alert(timeStr);
                    }
                    if (i == 4) {
                        timeStr = timeStr.charAt(0) + timeStr.charAt(1) + ':' + timeStr.charAt(2) + timeStr.charAt(3);
                        //alert(timstr);
                    }
                }
                
                var matchArray = timeStr.match(timePat);
                if (matchArray == null) {
                    alert("Time is not in a valid format.");
                    return false;
                }
                hour = matchArray[1];
                minute = matchArray[2];
                second = matchArray[4];
                
                if (second == "") { second = null; }
                
                
                if (hour < 0 || hour > 23) {
                    alert("Hour must be between 1 and 12. (or 0 and 23 for 24hr Format)");
                    return false;
                }
                
                if (minute < 0 || minute > 59) {
                    alert("Minute must be between 0 and 59.");
                    return false;
                }
                if (second != null && (second < 0 || second > 59)) {
                    alert("Second must be between 0 and 59.");
                    return false;
                }
                
            }
            if (paymenttype.value != "") {
                if (paymentAmount.value == "") {
                    alert('You selected a payment type but no payment amount')
                    return false;
                }
            }
            if (paymenttype.value == "Check") {
                if (Check.value == "") {
                    alert('You selected Check type but no Check Number')
                    return false;
                }
            }
            
            
            
            
            var fChemical = divs - 1;
            
            
            
            
            
            for (i = 1; i <= divs - 1; i++) {
                var ammt = document.getElementById('amount' + i);
                if (ammt.value != "") {
                    
                    //var units = document.getElementById('units' + i);
                    var schem = document.getElementById('chemicals' + i);
                    var fchem = schem.options[schem.selectedIndex].text;
                    var sper = document.getElementById('dPercent' + i);
                    var fper = sper.options[sper.selectedIndex].text;
                    var ssite = document.getElementById('dSite' + i);
                    //var fsite = ssite.options[ssite.selectedIndex].text;
                    var ssiteD = document.getElementById('dSiteDetail' + i);
                    //var fsiteD = ssiteD.options[ssiteD.selectedIndex].text;
                    var ob = document.getElementById('dPests' + i);
                    
                    
                    if (fchem == "") {
                        alert('Please Select a Chemical');
                        return false;
                    }
                    
                    var selected = '';
                    var cnt = ob.options.length - 1
                    // if (cnt <= 0) {
                    //     alert('Please Select a Pest for ' + fchem);
                    //    return false;
                    // }
                    for (z = 0; z <= cnt; z++) {
                        if (ob.options[z].selected)
                        selected += ob.options[z].value + ',';
                    }
                    
                    var Siteselected = '';
                    var cnt = ssite.options.length - 1
                    // if (cnt <= 0) {
                    //     alert('Please Select a Site for ' + fchem);
                    //     return false;
                    // }
                    for (z = 0; z <= cnt; z++) {
                        if (ssite.options[z].selected)
                        Siteselected += ssite.options[z].value + ',';
                    }
                    var ticket = document.getElementById('ticketinfo' + i);
                    var unit = document.getElementById('units' + i);
                    
                    fChemical += '!' + fchem + '&' + fper + '&' + Siteselected + '&' + selected + '&' + ammt.value + '&' + unit.value + '&' + ticket.value;
                    
                }
            }
            
            // alert(fChemical);
            
            var ServiceTypeCode = document.getElementById('servicetypecode').value;
            var Result = document.getElementById('Result').value;
            var paymenttype = document.getElementById('paymenttype').value;
            var Check = document.getElementById('Check').value;
            var paymentAmount = document.getElementById('paymentamount').value;
            var Comments = document.getElementById('Comments').value;
            
            var CustName = document.getElementById('CustomerName').value;
            
            var addr = document.getElementById('Address').value;
            var citystate = document.getElementById('CityState').value;
            var phone = document.getElementById('Phone1').value;
            var preBal = document.getElementById('PrevBal').value;
            var charge = document.getElementById('Charge').value;
            
            
            
            
            
            
            
            
            
            
            
            
            
            var cnt = 0;
            
            
            var TechName = document.getElementById('techname').value.replace('%20', ' ');
            var licNum = document.getElementById('licNumber').value.replace('%20', ' ');
            
            var Account = AccountNumber.value;
            var Office = document.getElementById('office1').value
            var Customer = CustName.replace('%20', ' ');
            var Address = addr.replace("%20", " ");
            var CityState = citystate.replace("%20", " ");
            var Phone = phone.replace("%20", " ");
            var ServiceType = ServiceTypeCode.replace("%20", " ");
            //var ServiceDate = now();
            // alert(Office);
            
            
            var Chem1 = " ";
            var Chem2 = " ";
            var Chem3 = " ";
            var Chem4 = " ";
            var Chem5 = " ";
            var Chem6 = " ";
            var Chem7 = " ";
            var Chem8 = " ";
            
            var Chemdetail1 = " ";
            var Chemdetail2 = " ";
            var Chemdetail3 = " ";
            var Chemdetail4 = " ";
            var Chemdetail5 = " ";
            var Chemdetail6 = " ";
            var Chemdetail7 = " ";
            var Chemdetail8 = " ";
            
            
            var Site1 = " ";
            var Site2 = " ";
            var Site3 = " ";
            var Site4 = " ";
            var Site5 = " ";
            var Site6 = " ";
            var Site7 = " ";
            var Site8 = " ";
            
            
            var Pest1 = " ";
            var ob = "";
            
            
            var officeAddress = "1228 E Broadway Rd";
            var officeCity = "Mesa, AZ 85204";
            var officePhone = "(480) 969-7474";
            var officeLic = "LIC# 5632";
            //TN Office
            
            
            if (Office.indexOf("KN") != -1) {
                officeAddress = "830 N Broadway Suite 4";
                officeCity = "Knoxville, TN 37917";
                officePhone = "(865) 544-8400";
                officeLic = "CH# 4720";
                
                
                if (CityState.toUpperCase().indexOf("GA") != -1) {
                    officeAddress = "830 N Broadway Suite 4";
                    officeCity = "Knoxville, TN 37917";
                    officePhone = "(423) 702-6444";
                    officeLic = "LIC# 99440";
                    
                }
            }
            
            //St George Office
            if (Office.indexOf("GR") != -1) {
                
                
                
                officeAddress = "56 N 500 E";
                officeCity = "St George UT 84770";
                officePhone = "(435) 627-8840";
                officeLic = "LIC# 4000-467";
                
                
                if (CityState.toUpperCase().indexOf("NV") != -1) {
                    
                    officeAddress = "";
                    officeCity = "";
                    officePhone = "(702) 522-1355";
                    officeLic = "LIC# 5253";
                    
                }
                if (CityState.toUpperCase().indexOf("AZ") != -1) {
                    
                    officeAddress = "";
                    officeCity = "";
                    officePhone = "(866) 627-8840";
                    officeLic = "LIC# 5632";
                    
                }
                
            }
            
            
            if (Office.indexOf("PH") != -1) {
                
                
                
                officeAddress = "10401 N 91st Ave";
                officeCity = "Peoria AZ, 85345";
                officePhone = "(623) 572-3016";
                officeLic = "LIC# 5632";
                
            }
            if (Office.indexOf("SH") != -1) {
                
                
                
                officeAddress = "";
                officeCity = "";
                officePhone = "(928) 272-3530";
                officeLic = "LIC# 5632";
                
            }
            
            if (Office.indexOf("PR") != -1) {
                
                
                
                officeAddress = "";
                officeCity = "";
                officePhone = "(928) 272-3530";
                officeLic = "LIC# 5632";
                
            }
            
            if (Office.indexOf("LV") != -1) {
                
                officeAddress = "3932 Octagon Road";
                officeCity = " North Las Vegas NV, 89030";
                officePhone = "(702) 255-6313";
                officeLic = "LIC# 5253";
            }
            
            
            
            if (Office.indexOf("TU") != -1) {
                officeAddress = "9750 E 55th Pl";
                officeCity = "Tulsa OK, 74146";
                officePhone = "(918) 252-3548";
                officeLic = "LIC# C5839";
            }
            
            if (Office.indexOf("AU") != -1) {
                officeAddress = "209 E Ben White Blvd 115";
                officeCity = "Austin TX,78704";
                officePhone = "(512) 291-1200";
                officeLic = "TPCL #11431 & CA# 43410PT";
            }
            if (Office.indexOf("SA") != -1) {
                officeAddress = "17316 Bell North Dr";
                officeCity = "Shertz TX,78154";
                officePhone = "(210) 402-0492";
                officeLic = "TPCL #11431-A & CA# 43410PT";
            }
            
            if (Office.indexOf("HO") != -1) {
                officeAddress = "10900 Brittmore Park Dr Ste D";
                officeCity = "Houston TX,77041";
                officePhone = "(281) 668-4930";
                officeLic = "TPCL #11431-B & CA# 43410PT";
            }
            
            if (Office.indexOf("EA") != -1) {
                officeAddress = "5221 Palmero Court #105";
                officeCity = "Buford, GA 30518";
                officePhone = "(770) 904-4141";
                officeLic = "LIC# 99440";
                
            }
            
            if (Office.indexOf("CH") != -1) {
                officeAddress = "2300-a Stevens Mill Rd";
                officeCity = "Matthews NC, 28105";
                officePhone = "(704) 391-9838";
                officeLic = "LIC# 1636PW";
                
                
                if (CityState.toUpperCase().indexOf("SC") != -1) {
                    officeAddress = "2300-a Stevens Mill Rd";
                    officeCity = "Matthews NC, 28105";
                    officePhone = "(704)391-9838";
                    officeLic = "LIC# CA012596";
                    
                }
                
                
                
            }
            if (Office.indexOf("RD") != -1) {
                officeAddress = "10207-B Chapel Hill Rd";
                officeCity = "Morrisville, NC 27560";
                officePhone = "(919) 481-0007";
                officeLic = "LIC# 1636PW, 1787P";
            }
            
            if (Office.indexOf("GV") != -1) {
                officeAddress = "5600 Augusta Rd Ste A";
                officeCity = "Greenville, SC 29605";
                officePhone = "(864) 513-0720";
                officeLic = "LIC# B3203";
            }
            
            if (Office.indexOf("GB") != -1) {
                officeAddress = "508 Prescott St";
                officeCity = "Greensboro, NC 29605";
                officePhone = "(336) 662-0043";
                officeLic = "LIC# 1636PW";
            }
            if (Office.indexOf("TA") != -1) {
                officeAddress = "3535 McKinley Ave East";
                officeCity = "Tacoma, WA 98404";
                officePhone = "(253) 237-7017";
                officeLic = "LIC# CA88845";
            }
            if (Office.indexOf("CC") != -1) {
                officeAddress = "1022 Hancock Ave";
                officeCity = "Corpus Christi, TX 78404";
                officePhone = "(361) 792-0001";
                officeLic = "TPCL # 0715854";
            }
            if (Office.indexOf("SL") != -1) {
                officeAddress = "";
                officeCity = "";
                officePhone = "(801) 784-6688";
                officeLic = "LIC# 4000-1943";
            }
            //alert(officeAddress);
            
            
            ob += "<ESC>@<LF><LF><ESC>E1Bulwark Exterminating LLC<ESC>E0<LF>" + officeLic + "<LF>" + officeAddress + "<LF>" + officeCity + "<LF>" + officePhone + "<LF><LF>";
            
            
            
            var splittArray1 = [];
            if (fChemical != null && fChemical.length > 2) {
                splittArray1 = fChemical.split("!");
            }
            
            var space = 25;
            
            
            var currentTime = new Date();
            var month = currentTime.getMonth() + 1;
            var day = currentTime.getDate();
            var year = currentTime.getFullYear();
            // document.write(month + "/" + day + "/" + year)
            
            
            var hours = currentTime.getHours();
            var minutes = currentTime.getMinutes();
            var AMPM = "";
            if (minutes < 10) {
                minutes = "0" + minutes;
            }
            //document.write(hours + ":" + minutes + " ")
            if (hours > 11) {
                AMPM = "PM";
            } else {
                AMPM = "AM";
            }
            if (hours > 12) {
                hours = hours - 12;
            }
            var now = month + "/" + day + "/" + year + " " + hours + ":" + minutes + " " + AMPM;
            
            
            
            ob += "Service Time:" + now + "<LF>";
            ob += "Serviced By: " + TechName + "<LF>";
            
            if (licNum.length > 2) {
                ob += "License: " + licNum + "<LF>";
            }
            //ob += "<ESC>*p0x290Y";
            
            
            ob += "<LF>Account: <ESC>E1" + Account + "<ESC>E0<LF>";
            
            
            
            if (Customer != null && Customer.length > 26)
            Customer = Customer.substring(0, 26);
            
            
            //ob += "<ESC>*p0x350Y";
            ob += Customer + "<LF>";
            //ob.Color(iColor.BLACK);
            
            
            
            
            
            
            if (Address != null && Address.length > 31)
            Address = Address.substring(0, 31);
            
            
            
            
            //ob += "<ESC>*p0x400Y";
            ob += Address + "<LF>";
            
            
            if (CityState != null && CityState.length > 31)
            CityState = CityState.substring(0, 31);
            
            
            
            // ob += "<ESC>*p0x450Y";
            ob += CityState + "<LF>";
            
            
            
            //ob += "<ESC>*p0x500Y";
            
            ob += "ServiceType: " + ServiceType + "<LF>";
            
            
            var Stype = "General Pest";
            if (ServiceType.indexOf("TQT") != -1) {
                Stype = "Termite";
                
            }
            if (ServiceType.indexOf("TFU") != -1) {
                Stype = "Termite";
                
            }
            if (ServiceType.indexOf("TCB") != -1) {
                Stype = "Termite";
                
            }
            if (ServiceType.indexOf("TRNL") != -1) {
                Stype = "Termite";
                
            }
            if (ServiceType.indexOf("TSEAS") != -1) {
                Stype = "Termite";
                
            }
            if (ServiceType.indexOf("TEOM") != -1) {
                Stype = "Termite";
                
            }
            
            
            
            
            
            
            ob += "<LF><ESC>E1";
            //ob += "<ESC>*p0x680Y";
            ob += Stype + " Products Used<ESC>E0<LF><LF>";
            
            
            
            
            
            
            
            var tax = 1.00;
            
            
            if (CityState.indexOf("TX") != -1) {
                
                tax = 1.0825;
            }
            else if (CityState.indexOf("Tx") != -1) {
                
                tax = 1.0825;
            }
            else if (CityState.indexOf("tx") != -1) {
                
                tax = 1.0825;
            }
            else if (CityState.indexOf("tX") != -1) {
                
                tax = 1.0825;
            }
            
            
            var spacing = 40;
            var ycord = 760;
            var cpi = 14;
            var newrow = 32;
            
            
            for (var n = 1; n < splittArray1.length; n++) {
                
                
                
                if (splittArray1.length > 1) {
                    var splittArray2 = [];
                    if (splittArray1[n] != null) {
                        splittArray2 = splittArray1[n].split("&");
                        
                        Chem1 = splittArray2[0];
                        Site1 = splittArray2[2];
                        
                        
                        if (splittArray2.length > 6) {
                            Chemdetail1 = splittArray2[6];
                        }
                        
                        Pest1 += splittArray2[3];
                        
                        
                        
                        
                        
                        var splittArraySite = [];
                        if (Site1 != null || !Site1.equalsIgnoreCase("")) {
                            splittArraySite = Site1.split(" ");
                            
                        }
                        
                        var topline = "<ESC>E1" + Chem1 + "<ESC>E0  " + splittArray2[7] + " " + splittArray2[1] +  "<LF><ESC>E1Amount: <ESC>E0" + splittArray2[4] + " " + splittArray2[5];
                        
                        if (Office.indexOf("RD") != -1) {
                            topline = Chem1 + "   " + splittArray2[7] + "<LF><ESC>E1EPA:<ESC>E0 " + splittArray2[8];
                        }
                        if (Office.indexOf("CH") != -1) {
                            topline = Chem1 + "   " + splittArray2[7] + "<LF><ESC>E1EPA:<ESC>E0 " + splittArray2[8];
                        }
                        if (Office.indexOf("EA") != -1) {
                            topline = Chem1 + "   " + splittArray2[7] + "<LF><ESC>E1Amount: <ESC>E0" + splittArray2[4] + " " + splittArray2[5] + "<LF><ESC>E1EPA:<ESC>E0 " + splittArray2[8];
                        }
                        if (Office.indexOf("GV") != -1) {
                            topline = Chem1 + "   " + splittArray2[7] + "<LF><ESC>E1EPA:<ESC>E0 " + splittArray2[8];
                        }
                        
                        // ob += "<ESC><PER>s" + cpi + "H";
                        // ob += "<ESC>*p0x" + ycord + "Y";
                        // ob += "<ESC><PER>s2B";
                        // ob += "<ESC><PER>s16H";
                        
                        
                        ob += "<ESC>E1"
                        
                        ob += topline;
                        
                        
                        ycord += spacing;
                        //p.Add(ob);
                        
                        var Sitestr = "<ESC>E1Site- <ESC>E0";
                        for (var i = 0; i < splittArraySite.length; i++) {
                            var q = Sitestr.length + splittArraySite[i].length - 14;
                            if (q > newrow) {
                                
                                ob += "<LF>";
                                //ob += "<ESC><PER>s-5B";
                                
                                ob += Sitestr;
                                
                                ycord += spacing;
                                
                                var comm = " ";
                                var r = splittArraySite.length - 1;
                                if (i >= r) {
                                    comm = " ";
                                }
                                
                                Sitestr = splittArraySite[i] + comm;
                                
                            }
                            else {
                                var comm = " ";
                                var r = splittArraySite.length - 1;
                                if (i >= r) {
                                    comm = " ";
                                }
                                Sitestr += "" + splittArraySite[i] + comm;
                                
                            }
                        }
                        
                        //ob+="<ESC>(s" + cpi + "H";
                        ob += "<LF>";
                        //ob += "<ESC><PER>s-5B";
                        //ob+="<ESC>(s8H";
                        ob += Sitestr;
                        
                        ycord += spacing;
                        
                        if (Office.indexOf("EA") != -1) {
                            
                            ob += "<LF>";
                            
                            ob += "<ESC>E1Pests: <ESC>E0" + Pest1;
                            
                            ycord += spacing;
                            
                        }
                        
                        ob += "<LF>";
                        // ob += "<ESC><PER>s1S";
                        
                        if (Chemdetail1.length > 4) {
                            ob += Chemdetail1;
                            
                            ycord += spacing;
                            
                            cnt += 1;
                        }
                        cnt += 2;
                        
                    }
                    
                }
                
                ycord += (spacing / 2);
                ob += "<LF>";
                
            }
            
            
            if (Office.indexOf("EA") == -1) {
                
                
                
                var splittArraypests1 = [];
                if (Pest1 != null || !Pest1.equalsIgnoreCase("")) {
                    splittArraypests1 = Pest1.split(",");
                    
                }
                
                
                var Pests2 = "";
                var Pests1 = "<ESC>E1Target Pests:<ESC>E0";
                var Pesttest = "";
                for (var i = 0; i < splittArraypests1.length; i++) {
                    var q = Pests1.length + splittArraypests1[i].length;
                    if (q > newrow) {
                        ob += "<LF>";
                        //ob += "<ESC><PER>s1S";
                        ob += Pests1;
                        
                        // ob.Italic();
                        
                        ycord += spacing;
                        
                        Pesttest += Pests1;
                        Pests1 = "";
                        
                        var comm = ", ";
                        var r = splittArraypests1.length - 1;
                        if (i >= r) {
                            comm = " ";
                        }
                        
                        if (Pests2.indexOf(splittArraypests1[i]) != -1) {
                            
                        }
                        else {
                            Pests1 = splittArraypests1[i] + comm;
                            Pests2 += Pests1;
                        }
                    }
                    else {
                        var comm = ", ";
                        var r = splittArraypests1.length - 1;
                        if (i >= r) {
                            comm = " ";
                        }
                        if (Pests2.indexOf(splittArraypests1[i]) != -1) {
                            
                        }
                        else {
                            Pests1 += splittArraypests1[i] + comm;
                            Pests2 += Pests1;
                        }
                    }
                }
                ob += "<LF>";
                //ob += "<ESC><PER>s1S";
                ob += Pests1;
                
                ycord += spacing;
                
                Pesttest += Pests1;
                
            }
            
            
            
            
            
            
            
            var Space = " ";
            
            
            var Pervious = CurrencyFormatted(parseFloat(preBal));
            
            if (Pervious.length == 4) {
                Space = "  ";
            }
            else if (Pervious.length == 5) {
                Space = " ";
            }
            else {
                Space = "";
            }
            ob += "<LF><LF><LF>";
            ob += "    Previous Balance:" + Space + "$" + Pervious;
            
            ycord += spacing;
            
            var current = CurrencyFormatted(parseFloat(charge) * parseFloat(tax));
            
            if (current.length == 4) {
                Space = "  ";
            }
            else if (current.length == 5) {
                Space = " ";
            }
            else {
                Space = "";
            }
            ob += "<LF>";
            ob += "      Current Charge:" + Space + "$" + current;
            
            var total = CurrencyFormatted((parseFloat(charge)  * parseFloat(tax)) + parseFloat(preBal));
            
            if (total.length == 4) {
                Space = "  ";
            }
            else if (total.length == 5) {
                Space = " ";
            }
            else {
                Space = "";
            }
            
            
            ob += "<LF>";
            ob += "         New Balance:" + Space + "$" + total;
            ob += "<LF><LF><LF>";
            
            ob += "WARNING PESTICIDES CAN BE       HARMFUL KEEP CHILDREN AND PETS  AWAY FROM PESTICIDE APPLICATIONSUNTIL DRY, DISSIPATED,OR AERATEDFOR MORE INFORMATION CONTACT    BULWARK EXTERMINATING LLC.      (" + officeLic + ") AT " + officePhone;
            
            ob += "<LF><LF><LF><LF><LF>";
            
            
            
            
            
            
            
            
            mail_to_link = "bulwarktw://?28?" + ob;
            window.open(mail_to_link);
            
            return false
            
            //alert(AccountNumber.value);
            //return false;
            //var datastr = "Success"
            // var datastr = window.demo.postPrintNC(Invoice.value, AccountNumber.value, Result.value, hr_emp_id.value, paymentAmount.value,
            // Check.value, Comments.value, Route_Id.value, paymenttype.value, startDate.value, servicetypecode.value, CustName.value, addr.value, citystate.value
            // phone.value, preBal.value, charge.value, fChemical);
            
            //alert(datastr);
            
            
            
            
            
        }
        function CurrencyFormatted(amount) {
            var i = parseFloat(amount);
            if (isNaN(i)) { i = 0.00; }
            var minus = '';
            if (i < 0) { minus = '-'; }
            i = Math.abs(i);
            i = parseInt((i + .005) * 100);
            i = i / 100;
            s = new String(i);
            if (s.indexOf('.') < 0) { s += '.00'; }
            if (s.indexOf('.') == (s.length - 2)) { s += '0'; }
            s = minus + s;
            return s;
        }
        
        function queryString(parameter) {
            var loc = '%paramaterstoreplace%';
            var param_value = false;
            var params = loc.split("&");
            for (i = 0; i < params.length; i++) {
                param_name = params[i].substring(0, params[i].indexOf('='));
                if (param_name == parameter) {
                    param_value = params[i].substring(params[i].indexOf('=') + 1)
                }
            }
            if (param_value) {
                return param_value;
            }
            else {
                return false; //Here determine return if no parameter is found
            }
        }
        
        
        //kap
        
        
        function makeChemicalObj() {
            
            var cTable = '<div style="   background-color:white;border:1px solid black;">' +
            '<table style="width:24%;">' +
            '<tr>' +
            '<td class="style1">' +
            'Chemical:</td>' +
            '<td class="style2">' +
            '<div id="SelectChem' + divs + '" />' +
            '</td>' +
            '<td>' +
            '<div id="percent' + divs + '" >' +
            '</td>' +
            '</tr>' +
            '<tr>' +
            '<td class="style1">' +
            'Site/Detail:</td>' +
            '<td class="style2">' +
            '<div id="site' + divs + '" />' +
            '</td>' +
            '<td>' +
            '<div id="sitedetail' + divs + '" />' +
            '</td>' +
            '</tr>' +
            '<tr>' +
            '<td class="style1">' +
            'Pests:</td>' +
            '<td class="style2">' +
            '<div id="pests' + divs + '" />' +
            '</td>' +
            '<td>' +
            '' +
            '</tr>' +
            
            '<tr>' +
            '<td class="style1">' +
            'Quantity</td>' +
            '<td class="style2">' +
            '<input id="amount' + divs + '" type="number" style="width:118px;" /></td>' +
            '<td>' +
            '<input id="units' + divs + '" type="text" style="width:60px;" />' +
            '</td>' +
            '' +
            '</tr>' +
            '' +
            '</table><input id="ticketinfo' + divs + '" type="hidden" />' +
            '</div>';
            
            switch (divs) {
                case 1:
                document.getElementById('Invoice').value = queryString('routestopid');
                
                chemical1.innerHTML = cTable;
                setchemlist('SelectChem' + divs);
                divs += 1;
                break;
                case 2:
                var schem = document.getElementById('chemicals1');
                var fchem = schem.options[schem.selectedIndex].text;
                if (fchem == "") {
                    alert('Please Select a Chemical');
                    return;
                }
                chemical2.innerHTML = cTable;
                setchemlist('SelectChem' + divs);
                divs += 1
                break;
                case 3:
                var schem = document.getElementById('chemicals2');
                var fchem = schem.options[schem.selectedIndex].text;
                if (fchem == "") {
                    alert('Please Select a Chemical');
                    return;
                }
                chemical3.innerHTML = cTable;
                setchemlist('SelectChem' + divs);
                divs += 1
                break;
                case 4:
                var schem = document.getElementById('chemicals3');
                var fchem = schem.options[schem.selectedIndex].text;
                if (fchem == "") {
                    alert('Please Select a Chemical');
                    return;
                }
                chemical4.innerHTML = cTable;
                setchemlist('SelectChem' + divs);
                divs += 1
                break;
                case 5:
                var schem = document.getElementById('chemicals4');
                var fchem = schem.options[schem.selectedIndex].text;
                if (fchem == "") {
                    alert('Please Select a Chemical');
                    return;
                }
                chemical5.innerHTML = cTable;
                setchemlist('SelectChem' + divs);
                divs += 1
                break;
                case 6:
                var schem = document.getElementById('chemicals5');
                var fchem = schem.options[schem.selectedIndex].text;
                if (fchem == "") {
                    alert('Please Select a Chemical');
                    return;
                }
                chemical6.innerHTML = cTable;
                setchemlist('SelectChem' + divs);
                divs += 1
                break;
                case 7:
                var schem = document.getElementById('chemicals6');
                var fchem = schem.options[schem.selectedIndex].text;
                if (fchem == "") {
                    alert('Please Select a Chemical');
                    return;
                }
                chemical7.innerHTML = cTable;
                setchemlist('SelectChem' + divs);
                divs += 1
                break;
                case 8:
                var schem = document.getElementById('chemicals7');
                var fchem = schem.options[schem.selectedIndex].text;
                if (fchem == "") {
                    alert('Please Select a Chemical');
                    return;
                }
                chemical8.innerHTML = cTable;
                setchemlist('SelectChem' + divs);
                divs += 1
                break;
                
                default:
                var schem = document.getElementById('chemicals7');
                var fchem = schem.options[schem.selectedIndex].text;
                if (fchem == "") {
                    alert('Please Select a Chemical');
                    return;
                }
                chemical8.innerHTML = cTable;
                setchemlist('SelectChem' + divs);
                divs += 1
            }
            
            
            
        }
        
        var defnum = 0;
        
        function defaultchem() {
            defaults = true;
            makeChemicalObj();
            makeChemicalObj();
            makeChemicalObj();
            defaults = false;
            
        }
        
        
        
        
        function setchemlist(chemicalSelect) {
            var defaultchem1 = 'Bifen LP,lb,Dampen granules to activate,,!*Spiders,*Roaches,Scorpions,*Crickets,*Earwigs?0.2%?Outside:Spot,$';
            var defaultchem2 = 'Cy-Kick CS (EP),oz,,,!*Spiders,Scorpions,*Crickets,*Earwigs,*Roaches,*Ants?0.1%?Outside,Outside:Spot,$';
            var defaultchem3 = 'PermaCap CS,gl,Do not touch treated area until dry,,!Scorpions,*Spiders,*Roaches,*Earwigs,*Crickets,Fleas,Ticks?0.072%?Outside:Perimeter,Garage,Outside:Fenceline,$';
            var chemicalString = 'Cy-Kick CS,Gal.,Do not touch treated ares until dry,Cyfluthrin,499-470!*crickets,*ants,Bed Bugs,*Boxelder Bugs,*Carpenter Ants,*Carpenter Bees,*Carpet Beetles,*Centipedes,*Clover Mites,*Cockroaches,*Earwigs,*Fire Ants,*Hornets,*Millipedes,*Mosquitoes,*Silverfish,*Spiders,*Springtails,*Ticks,*Yellow Jackets,*Wasps?.025%,.05%,.06%?Outside,Outside:Perimter,Outside:Mulch area,Outside:Fence Line,$Wisdom,Gal.,Do Not /touch Treated Area Until Dry,Bifenthrin 7.9%,5481-520!*Ants,*Centipedes,*Crickets,*Earwigs,*Fleas,*Millipedes,*Mites,*Ticks,*Fire Ants?0.25%,0.50%?Perimeter,Perimeter:Perimeter,Perimeter:Fence Line,$Mavrik,oz.,Do Not Touch Treated Area Until Dry,Tau-fluvalinate 22.3%,2724-78!*Clover Mites,*Mosquitoes,*Springtails?.10%?Outside,Outside:Perimeter,$Termidor SC,Gal.,Do Not Touch Until Areas Dry,Fipronil .06%,432-901!*Ants?.125%?Outside,Outside:Perimeter,$Bifen PL G,gran,Dampen granules to activate,Bifenthrin .2%,279-3168!*Ants,*centipedes,*crickets,*earwigs,*Fleas,*Millipedes,*Ticks,*Fire Ants?.20%?Outside,Outside:Perimeter,$Phantom,gal.,Do not touch areas until dry,Chlorophenyl-1,24-1392!*Ants,*Bed Bugs,*Roaches?.25%?outside,outside:perimeter,$ExciteR,oz.,Do not touch areas until dry,Pyrethrins,655-798!*Ants,*Cockroaches,*Fleas,*Ticks,*Pantry Pests,*Carpet Beetles,*Gnats,*Mosquitoes,*Crickets,*earwigs?.25%?Outside,Outside:Perimeter,Outside:Pantry Pests,Interior,$Precor,oz,Do not touch areas until dry,Pemethrin,2724-483!Fleas,Ticks?.007%?Inside,Outside,$NiBan-FG,oz.,interior and exterior,Orthoboric Acid,64405-2!*crickets,*cockroaches,*silverfish,*ants,*earwigs?5%?interior and exterior,interior and exterior:in and around homes,interior and exterior:gargages,$Terro-PCO,oz,Do Not Touch,borax,NA!*ants?5.4%?interior,exterior,$Advion Fire Ant Bait,lb,,Indoxacarb,352-627!*fire ants?0.045%?*lawns,$MaxForce,gel,keep away from kids and pets,Fipronil,432-1259!*cockroaches?.01%?cracks and crevices,cracks and crevices:*kitchen,cracks and crevices:*bathroom,cracks and crevices:*living room,cracks and crevices:*basement,$Pro Pest,grams,Do Not Touch,food grade,NA!*rodents?100%?*interior,*interior:*glueboards,*interior:*snap traps,$Optigard Gel,gel,Do Not Touch,Thiamethoxam,100-1260!*Pharaoh Ants?0.010%?*Interior,*Interior:*Every Room,*Interior:*living Room,*Interior:*kitchen,*Interior:*dining room,*Interior:*family room,*Interior:*bathroom,*Interior:*bedroom,*Interior:*garage,*outdoor,$';
            
            
            
            defaultchem1 = 'Bifen LP,lbs,Applied According to Label,Bifenthrin,53883-124!*Spiders,*Scorpions,*Crickets,Fleas,Ants?0.2%?Exterior:Perimeter,$';
            defaultchem2 = 'Fendona CS,gal,Do not touch treated areas until dry,alpha-Cypermethrin,7969-MO-001!*Spiders,*Ants,*Scorpions,*Crickets,*Earwigs,*Roaches,Fleas,Ticks,Springtails,Centipedes,Silverfish,Flies?.008%,.01%,.0125%,.0064%?*Outside:Perimeter,*Outside:Exterior Spray,*Outside:Fenceline,Garage,Interior,Kitchen:Perimeter,Kitchen:Spot,Bathroom,Living Room,Bedroom,$';
            defaultchem3 = 'Fendona CS (EP),oz,Do not touch treated area until dry,alpha-Cypermethrin,7969-MO-001!*ants,*Crickets,*Cockroaches,*Earwigs,*Spiders,*Scorpions,Milipedes,Silverfish,Springtails,Wasps?.05%?*Outside:*Perimeter,*Outside:Spot,Garage,$';
            var termitechemstring = 'Adv. 375A Sel. Gran. Ant Bait,oz,,Abamecrin,499-370!Ants?0.011%?Outside:Bait Placement,$Adv. Termite Insp. Cart.,ctg,,(none),123!Termites?0%?Outside,$Advance Termite Bait Cart.,ctg,,Diflubenzuron,499-488!Termites?0.25%?Outside Perimeter:Bait Placement,$MaxForce Gran. Insect Bait,oz,,Hydramethylon,64248-6!Ants?1.0%?Outside:Bait Placement,$Premise Foam,oz,,Imidacloprid,432-1391!Termites?0.05%?Interior,Kitchen,Bedroom,Bathroom,Attic,Garage,$Premise G,lb,,Imidacloprid,432-1385!Termites?0.5%?Outside,$Termidor Dry,Grams,,Fipronil,499-546!Termites?.5%?Interior:Spot,Exterior,$Termidor SC,oz,,Fipronil,123!Termites?0.125%,0.06%?Outside:Perimeter,Outside:In Wall Drilling,Outside:Interior Drilling,Outside:Exterior Drilling,Outside:Trenching,Outside:Rodding,Outside:Sub Slab Injection,Interior:Foam,Kitchen:Foam,Bedroom:Foam,Bathroom:Foam,Attic:Foam,Garage:Foam,$Trelona,Crtg,,Novaluron,499-557!Termites?.5%?Outside Perimeter:Bait Placement,$';
            var commercialchemstring = 'Bifen LP,lb,,Bifenthrin,123!*Spiders,*Scorpions,*Roaches,*Earwigs?0.2%?Outside:Spot,inside,$CB-80,oz,,Pyrethrins,123!Wasps,Bees,Spiders?0.50%?Outside:Spot,$Contrac Blox,blk,,Bromadiolone,123!Rats,Mice?0.005%?Outside:Bait Placement,$Cy-Kick CS,gl,,Cyfluthrin,123!*Scorpions,*Crickets,*Spiders,*Earwigs,*Roaches?0.02%,0.05%,0.10%?Food Consumption:Spot,Food Consumption:Crack/Crevice,Food Preparation:Spot,Food Preparation:Crack/Crevice,Rest Room:Spot,Rest Room:Crack/Crevice,Office:Spot,Office:Crack/Crevice,Classroom:Spot,Classroom:Crack/Crevice,*Outside:Spot,*Outside:Crack/Crevice,*Outside:Perimeter,*Outside:*Exterior spray,$Exciter,gl,,Pyrethrins,123!Scorpions,Spiders,Roaches,Earwigs,Crickets?0.0125%?Outside:Perimeter,Outside:Exterior Spray,$Glue Board,1,,N/A,N/A!Spider,Cricket,Ant?.01%?Interior:Bait Placement,$InTice Granular Bait,oz,,Orthoboric Acid,123!*Ants,Crickets,Roaches,Silverfish,Earwigs?5.0%?Food Consumption:Bait Placement,Food Preparation:Bait Placement,Rest Room:Bait Placement,Office:Bait Placement,Classroom:Bait Placement,Outside:Bait Placement,$Kicker,gl,,Pyrethrins,123!Scorpions,Crickets,Spiders,Roaches,Earwigs?0.0125%?Outside:Perimeter,Outside:Exterior Spray,$Maxforce Roach Bait Gel,oz,,Hydramethylon,123!German Roach,American Roach,Oriental Roach,Turkish Roach,Brown Banded Roach?2.15%?Food Consumption:Bait Placement,Food Preparation:Bait Placement,Rest Room:Bait Placement,Office:Bait Placement,Classroom:Bait Placement,$Microcare,oz,,pyrethroid,499-381!spiders,roaches,silverfish?.03%?inside:crack crevice,$Optigard,oz,,Thiamethoxam,123!*Ants?0.010%?Food Consumption:Bait Placement,Food Preparation:Bait Placement,Rest Room:Bait Placement,Office:Bait Placement,Classroom:Bait Placement,$Permacap CS,gl,,Permethrin,123!*Scorpions,*Spiders,*Crickets,*Earwigs,*Roaches?0.072%?Outside:Perimeter,Outside:Exterior Spray,Outside:Spot,Outside:Crack/Crevice,Food Consumption:Spot,Food Consumption:Crack/Crevice,Food Preparation:Spot,Food Preparation:Crack/Crevice,Rest Room:Spot,Rest Room:Crack/Crevice,Office:Spot,Office:Crack/Crevice,Classroom:Crack/Crevice,Classroom:Spot,$Phantom,oz,,Chlorfenapyr,123!Ants,Roaches?0.125%,0.025%?Food Consumption:Spot,Food Preparation,Rest Room,Office,Classroom,$Talstar P,Gallons,,Bifemthrin,279-3206!Spiders,Ants,Roaches?.015%?Exterior:Exterior,Exterior:Crack and Crevice,Interior,$Termidor SC,oz,,Fipronil,123!*Ants?0.06%?Outside:Spot,Outside:Exterior Spray,Outside:Perimeter,$Wasp Freeze,oz,,D-trans Alethrin & Carboxylate,123!Wasps,Bees?0.13 0.12?Outside:Spot,$';
            var gpchemstring = ',,,,!??$Advance G Carpenter Ant Bait,oz,,Abamectin B1,499-370!Carpernter Ants,*Ants?0.011%?Kitchen:Bait Placement,Bathroom:Bait Placement,Bedroom:Bait Placement,Garage:Bait Placement,$Advanced 375A,oz,,Avamectin B1,123!*Ants?0.011%?Outside:Bait Placement,Kitchen:Crack/Crevice,Kitchen:Void,Bedroom:Crack/Crevice,Bedroom:Void,Bathroom:Crack/Crevice,Bathroom:Void,Garage:Crack/Crevice,Garage:Void,Attic:Crack/Crevice,Attic:Void,$Alpine Pressurized Fly Bait,oz,Do not touch treated areas until dry,Dinotefuran,499-568!Flies,Fruit Flies?1.0%?Inside:Spot,Outside:Spot,Kitchen:Spot,Bathroom:Spot,Bedroom:Spot,$Alpine WSG,oz,,Dinotefuran,499-561!Ants,Flies,cockroaches?0.3%?Inside:void,Inside:crack and crevice,Outside:broadcast,Outside:perimeter,Outside:spot,$Ascend Fire ant Bait,oz,,Abamectim B1,499-371!Fireants,*Ants?0.011%?Outside:Bait Placement,$Bifen IT,gal,Do not touch till treated area is dry,Bifenthrin,53883-124!*Spiders,*Scorpions,*Crickets,*Earwigs,*Roaches,Ants?0.03%?Exterior:Perimeter,Exterior:Exterior Spray,Exterior:Fenceline,Garage,$Bifen LP,lbs,Applied According to Label,Bifenthrin,53883-124!*Spiders,*Scorpions,*Crickets,Fleas,Ants?0.2%?Exterior:Perimeter,$BorActin,oz,,Orthoboric Acid,73079.4!Crickets,Spiders,Scorpions,Roaches,Ants?99.0%?Kitchen:Void,Bathroom:Void,Garage,Bedroom,$Borid Turbo,oz,,Boric Acid (Pressurized),123!Roaches,Spiders,Scorpions,Crickets,Silverfish?20%?Kitchen:Crack/Crevice,Kitchen:Void,Bathroom:Crack/Crevice,Bathroom:Void,Bedroom:Crack/Crevice,Bedroom:Void,Garage:Crack/Crevice,Garage:Void,$CB-80,oz,,Pyrethrins,123!Wasps,Bees,Spiders?0.50%?Outside:Spot,$Contrac Blox,blocks,,Bromadiolone,123!Rats,Mice?0.005%?Outside:Bait Placement,$Cy-Kick CS,gal,Do not touch treated areas until dry,Cyfluthrin,499-304!*Scorpions,*Spiders,*Crickets,*Earwigs,*Roaches,Ants,Fleas,Ticks,Springtails,Centipedes,Silverfish,Flies?0.025%,0.015%,0.05%?Outside:Perimeter,Outside:Exterior Spray,Outside:Fenceline,Garage,$Cy-Kick CS (can),oz,Do not touch treated areas until dry.,Cyfluthrin,123!*Spiders,*Scorpions,*Roaches,*Silverfish,*Earwigs,Fleas,Ticks,Beetles,Springtails,Ants,Centipedes,Flies,Mosquitoes?0.10%?Kitchen:Spot,Kitchen:Crack/Crevice,Bedroom:Spot,Bedroom:Crack/Crevice,Bathroom:Spot,Bathroom:Crack/Crevice,Garage:Spot,Garage:Crack/Crevice,$Cy-Kick CS (EP),oz,Do not touch treated area until dry,Cyfluthrin,499-303!*Spiders,*Scorpions,Crickets,Earwigs,Roaches,Ants?0.1%?Outside:Spot,$DeltaDust,gr,,Deltamethrin,123!*Spiders,*Scorpions,*Roaches,*Crickets,*Silverfish,*Earwigs,Bees?0.10%?Outside:Void,Bedroom:Void,Bathroom:Void,Attic:Void,Garage:Void,*Interior:*Void,$D-Force HPX,oz,,Deltamethrin,123!Silverfish,Crickets,*Scorpions,Spiders,Roaches?0.06%?Kitchen:Spot,Kitchen:Crack/Crevice,Bedroom:Spot,Bedroom:Crack/Crevice,Bathroom:Crack/Crevice,Bathroom:Spot,$EcoEXEMPT IC2,Gal,,Rosemary Oil, Peppermint Oil,123!*Spiders,*Crickets,*Roaches,*Earwigs,*Silverfish,*Scorpions?0.4%?Outside:Perimeter,Outside:Fenceline,Garage,$EcoPCO D,gr,,Hexa-Hydroxyl,123!*Spiders,*Crickets,*Scorpions,*Roaches,*Silverfish?6.25%?Outside:Void,Kitchen:Void,Bedroom:Void,Bathroom:Void,Attic:Void,Garage:Void,$End Zone Insecticide Sticker,Sticker,Applied According to Label,Acetamiprid,8033-114-279!House Flies?0%?Interior:Bait Placement,Exterior,$Essentria IC3,Gal,,Rosemary Oil, Geraniol, Peppermint Oil,Exempt!*Scorpions,*Spiders,*Silverfish,*Earwigs,Ants,*Cockroaches?0.4%?Outside:Perimeter,Outside:Spot,Outside:Crack and Crevice,Garage,$ExciteR,gallons,,Pyrethrins, Poperonyl Butoxide,655-798!?0?$Fendona CS,gal,Do not touch treated areas until dry,alpha-Cypermethrin,7969-MO-001!*Spiders,*Ants,*Scorpions,*Crickets,*Earwigs,*Roaches,Fleas,Ticks,Springtails,Centipedes,Silverfish,Flies?.008%,.01%,.0125%,.0064%?*Outside:Perimeter,*Outside:Exterior Spray,*Outside:Fenceline,Garage,Interior,Kitchen:Perimeter,Kitchen:Spot,Bathroom,Living Room,Bedroom,$Fendona CS (EP),oz,Do not touch treated area until dry,alpha-Cypermethrin,7969-MO-001!*ants,*Crickets,*Cockroaches,*Earwigs,*Spiders,*Scorpions,Milipedes,Silverfish,Springtails,Wasps?.05%?*Outside:*Perimeter,*Outside:Spot,Garage,$First Strike,blocks,,Difethialone,123!Rats,Mice?0.0025%?Outside:Bait Placement,$Gentrol,oz,,(S)-Hydroprene,123!*Roaches?0.36%?Kitchen:Spot,Bedroom:Spot,Bathroom:Spot,Garage:Spot,Outside:Spot,Outside:Perimeter,$Gentrol Aerosol(can),oz,,(S)-Hydroprene,123!*Roaches?0.36%?Kitchen:Spot,Kitchen:Crack/Crevice,Bedroom:Spot,Bedroom:Crack/Crevice,Bathroom:Spot,Bathroom:Crack/Crevice,Garage:Spot,Garage:Crack/Crevice,$Glueboard,each,,None,Exempt!Mice,Rats,Scorpions,Spiders,Roaches,Flies?0?Outside,Garage,Interior,Kitchen,Bathroom,Bedroom,Attic,$Glyphosate Plus Herbicide,Gallons,Do Not Touch Treated Areas Until Dry,Glyphosate,66222-176!Weed Control?0.5%?Exterior,$Harmonix,Gallons,do not touch treated area until dry,Pyrethrin,432-1526!Ants*,Cockroaches*,Crickets*,Spiders*,Earwigs*,Millipedes,Sow Bugs,Springtails,Wasps?.06%?Exterior*,Interior:Perimeter*,Interior:Spot,Interior:Crack and Crevice,$Inspection Only,0,,0,0!*Inspection?0%?Interior,Exterior,Garage,Attic,$InTice Granular Bait,lbs,,Orthoboric Acid,123!Crickets,Earwigs,*Ants,Roaches,Silverfish?5.0%?Outside:Bait Placement,Kitchen:Bait Placement,Bedroom:Bait Placement,Bathroom:Bait Placement,Garage:Bait Placement,$InTice10 Granular Bait,lbs,,Orthoboric Acid,123!*Crickets,*Ants,*Cockroaches,*Earwigs?10%?Outside,$Kicker,gl,,Pyrethrins,123!Spiders,Ticks,Fleas,Scorpions,Roaches,Crickets,Springtails,*Earwigs?0.0125%?Outside:Perimeter,Outside:Exterior Spray,$Masterline Bifen,gal,Dont touch treated areas until dry,Bifetharin,1!*Scorpion,Crickets,Ants,Spiders?0.01%?Outside:Yard,Outside:Perimiter,$Maxforce Granular Insect Bait,oz,,Hydramethylon,123!Roaches,Crickets,Ants,Earwigs,Silverfish?1%?Outside:Bait Placement,$Maxforce Roach Bait Gel,oz,,Hydramethylon,432-1264!*German Roaches,American Roaches,Oriental Roaches,Brown Banded Roaches,Turkish Roaches?2.15%?Kitchen:Bait Placement,Bathroom:Bait Placement,Bedroom:Bait Placement,$Microcare,oz,,Pyrethrins,123!*Roaches,*Spiders,*Crickets,*Scorpions,Ants,*Silverfish?0.3%?Kitchen:Spot,Kitchen:Crack/Crevice,Bedroom:Spot,Bedroom:Crack/Crevice,Bathroom:Crack/Crevice,Bathroom:Spot,$Microcare 3% CS,Gal,Do not touch treated areas until dry,Pyrethrins, Piperonyl Butoxide,123!*Crickets,*Spiders,*Cockroaches,*Earwigs,*Scorpions?0.04%?Outside,Garage:Perimeter,Garage:Exterior Spray,Garage:Fenceline,$Niban,oz,,Orthoboric Acid,123!Ants,Crickets,Earwigs,Roaches,Silverfish?5.0%?Outside:Bait Placement,Kitchen:Bait Placement,Bedroom:Bait Placement,Bathroom:Bait Placement,Garage:Bait Placement,Attic,$Nuvan Prostrips,strips,Keep area enclosed as much as possible.,Dichlorvos,5481-533!?0?$Optigard,oz,,Thiamethoxam,123!*Ants?0.010%?Kitchen:Bait Placement,Bedroom:Bait Placement,Bathroom:Bait Placement,Outside,$Pendulum AquaCap,gallons,Do not touch treated areas until dry,pendimethalin 38.7%,241-416!Weed control?4.2%?Outside:Exterior Spray,$PermaCap CS,gl,,Permethrin,123!*Scorpions,*Spiders,*Roaches,*Earwigs,*Crickets,Fleas,Ticks?0.144%,0.072%,0.5%?Outside:Perimeter,Outside:Exterior Spray,Outside:Fenceline,Garage,$Permethrin SFR,Gal,Do not touch treated areas until dry,Permethrin,53883-TX-002!Fleas,Ticks,*Scorpions,*Spiders,*Crickets,*Earwigs?0.125%?Outside:Perimeter,Outside:Exterior Spray,Outside:Spot,Outside:Crack/Crevice,Outside:Yard Spray,$Phantom,oz,,Chlorfenapyr,123!Roaches,*Ants,Bedbugs?0.125%,0.025%?Kitchen:Spot,Bedroom:Spot,Bathroom:Spot,Garage:Spot,$Precor2000,oz,,Methoprene and Permethrin,123!*Fleas,Ticks?0.09 0.50?Bedroom,Bathroom,Kitchen,$Round Up Quick Pro,gallons,Do Not touch treated areas until dry,Glyphosate 73.3%; Diquat Dibromide 2.9%,524535!Weed Control?0.5%?Outside:Exterior Spray,$Snake Away,Pds,,Naphthalene,58630-1!Snakes?0?$Snap Trap,each,Do not touch trap(s),none,exempt!Mice,Rats?0?Outside,Inside,Garage,Attic,Kitchen,Bathroom,Bedroom,$Suspend Sc,gl,,Deltamethrin,123!*Spiders,Scorpions,Crickets,Roaches,Bedbugs,Earwigs,Fleas,Weeviles,Meal Moth,Silverfish?0.01%,0.06%?Outside:Perimeter,Outside:Spot,Outside:Exterior Spray,Outside:Fenceline,$Talstar Insecticide,oz,,Bifenthrin and prallethrin,279-3365!Spiders,Cockroaches?.05%,.03%?Int:crack and crevice,$Talstar PL,gl,,Bifenthrin,123!*Spiders,*Scorpions,*Roaches,*Crickets,*Earwigs?0.2%,0.03%?Outside:Void,Outside:Spot,Outside:Perimeter,Outside:Exterior Spray,Outside:Crack/Crevice,Outside:Yard Spray,Pest Tubes:Void,$Tempo Dust,gr,,Cyfluthrin,123!*Scorpions,Spiders,Cockroaches,Crickets,Earwigs?1%?Outside:Void,Kitchen:Void,Bedroom:Void,Bathroom:Void,Attic:Void,Garage:Void,$Temprid FX,gal,Do NOT touch treated areas until dry.,Imidacloprid 21%; B-Cyfluthrin 10.5%,432-1544!*Ants,*Spiders,*Scorpions,*Crickets,*Roaches,*Silverfish,Wasps,Beetles?0.01881%,0.03761%?Exterior:*Perimeter,Garage:Perimeter,Interior,$Temprid Readyspray,oz,,Imidicloprid, Cyfluthrin cyano dimethyl,432-1527!*Scorpions,*Spiders,Ants,Cockroaches,Earwigs,Silverfish,Springtails?.05%?Interior:Spot,Interior:Crack and Crevice,Interior:Void,Garage,$Temprid SC,Gallons,Do Not Touch Treated Area Until Dry,Imidacloprid 21%; Beta-Cyfluthrin 10.5%,432-1483!Ant,*Crickets,*Cockroaches,*Earwigs,Silverfish,*Spiders,*Scorpions,Wasps,Fleas,Ticks,Springtails,Centipedes?.03761%,.01881%?Exterior:Perimeter,Garage,Interior:*Perimeter,$Termidor SC,oz,,Fipronil,123!*Ants,Termites?0.06%?Outside:spot,$Tribune Herbicide,Gallons,Do Not Touch Treated Areas Until Dry,Diquat dibromide 37.3%,100-1390!Weed Control?0.25%?Exterior,$Vendetta Plus,30grams,,Abamectin B1 0.05% Pyripoxyfen 0.50%,1021-2593!cockroaches?0?kitchen,living area,bathroom,pantry,trash can,attic,$Wasp Freeze,oz,,D-trans Alethrin Carboxylate,123!*Wasps,Bees?0.13 0.12?Outside:Spot,$Web Out,oz,,Thyme Oil 2.0%, Lemongrass Oil 2.0%,Soap/Cleaner!Spiders?0.0%?Exterior:Spot,Exterior:Crack and Crevice,$Wisdom G,lbs,Applied According to Label,Bifenthrin,5481-521!Armyworms,Sod Webworms,Cutworms,Annual Bluegrass Weevil,Chinch Bugs,Billbugs,Crickets,Ants,Ticks?0.2%?Exterior:Perimeter,$';
            
            var st = document.getElementById('servicetypecode').value;
            
            chemicalString = gpchemstring;
            
            if (st == 'TQT') {
                chemicalString = termitechemstring;
            }
            if (st == 'TRNL') {
                chemicalString = termitechemstring;
            }
            if (st == 'TFU') {
                chemicalString = termitechemstring;
            }
            if (st == 'TFUP') {
                chemicalString = termitechemstring;
            }
            if (st == 'TI') {
                chemicalString = termitechemstring;
            }
            if (st == 'TCB') {
                chemicalString = termitechemstring;
            }
            if (st == 'TIS') {
                chemicalString = termitechemstring;
            }
            if (st == 'TEOM') {
                chemicalString = termitechemstring;
            }
            if (st == 'TSEAS') {
                chemicalString = termitechemstring;
            }
            
            if (st == 'CS') {
                chemicalString = commercialchemstring;
            }
            
            if (defaults == true) {
                if (defnum == 0) {
                    chemicalString = defaultchem1 + chemicalString;
                    
                }
                if (defnum == 1) {
                    chemicalString = defaultchem2 + chemicalString;
                    
                }
                if (defnum == 2) {
                    chemicalString = defaultchem3 + chemicalString;
                    
                }
            }
            
            var chemstring = chemicalString.split('$');
            defnum += 1;
            
            var select = document.getElementById(chemicalSelect);
            
            //var nameinfo;
            
            var opText = '';
            var i = 0;
            for (i = 0; i <= chemstring.length - 1; i++) {
                
                if (chemstring[i] != "") {
                    
                    var ChemName = chemstring[i].split('!');
                    var chem = ChemName[0].split(",")[0];
                    var val = ChemName[1];
                    //var elOptNew = document.createElement('option');
                    //elOptNew.text = chem;
                    //elOptNew.value = val;
                    //nameinfo = ChemName[0];
                    opText += '<option value="' + chemstring[i] + '">' + chem + '</ option>';
                }
            }
            
            
            
            
            
            var htmlstr = '<select id="chemicals' + divs + '" style="width:130px;" onchange="chemlistchange()">' +
            opText +
            '</select>';
            
            select.innerHTML = htmlstr;
            
            if (defaults == true) {
                
                
                chemlistchange();
                
            }
            
            
            
            // $(window).scrollTop($(document).height());
            $(div1).scrollTop(10000);
            $(window).scrollTop(10000);
            // $("html").animate({ scrollBottom: 100000 })
        }
        
        function SiteSelected(chemicalString) {
            //var chemicalString = 'Bifen IT,gl!Roaches,Scorpions,Ants,Crickets?.03%?Kitchen*NA,Bathroom*,Bedroom*,Outside*,Garage*$Bifen LP!crickets?.2%?outside*$chemical1!pest1,pest2,pest3?.025%,.063%?site1*NA,site2*NA,site3*NA,site4*$chemical2!pest1,pest2,pest3?.11%,.12%?site1*detail1|moreDetail,site2*,site3*$';
            
            
            var chemstring = chemicalString.split('|');
            
            
            var select = document.getElementById('sitedetail' + (divs - 1));
            
            
            
            var opText = '';
            var i = 0;
            for (i = 0; i <= chemstring.length - 1; i++) {
                
                if (chemstring[i] != "") {
                    
                    //var ChemName = chemstring[i].split('!');
                    var chem = chemstring[i];
                    var val = chemstring[i];
                    //var elOptNew = document.createElement('option');
                    //elOptNew.text = chem;
                    //elOptNew.value = val;
                    
                    opText += '<option value="' + val + '">' + chem + '</ option>';
                }
            }
            
            
            
            
            
            var htmlstr = '<select id="dSiteDetail' + (divs - 1) + '" style="width:130px;" >' +
            opText +
            '</select>';
            
            select.innerHTML = htmlstr;
        }
        
        function chemlistchange() {
            //alert('test');
            //return
            
            //alert(nameinfostr);
            
            
            
            
            
            
            if (defaults == true) {
                divs += 1;
            }
            
            var chemdet = document.getElementById('chemicals' + (divs - 1));
            var chemicalString = chemdet.value.split("!")[1];
            var namstr = chemdet.value.split("!")[0];
            
            
            document.getElementById('ticketinfo' + (divs - 1)).value = namstr.split(",")[2] + "&" + namstr.split(",")[3] + "&" + namstr.split(",")[4];
            document.getElementById('units' + (divs - 1)).value = namstr.split(",")[1];
            //alert(chemicalString);
            var detailstring = chemicalString.split('?');
            
            var chemstring = detailstring[1].split(",");
            
            var pse = 'percent' + (divs - 1)
            
            var select = document.getElementById(pse);
            
            
            
            var opText = '';
            var i = 0;
            for (i = 0; i <= chemstring.length - 1; i++) {
                
                if (chemstring[i] != "") {
                    
                    //var ChemName = chemstring[i].split('!');
                    var chem = chemstring[i];
                    var val = chemstring[i];
                    //var elOptNew = document.createElement('option');
                    //elOptNew.text = chem;
                    //elOptNew.value = val;
                    
                    opText += '<option value="' + val + '">' + chem + '</ option>';
                }
            }
            
            
            
            
            
            var htmlstr = '<select id="dPercent' + (divs - 1) + '" style="width: 72px" >' +
            opText +
            '</select>';
            
            select.innerHTML = htmlstr;
            
            //********************************************************************
            chemstring = detailstring[0].split(",");
            
            pse = 'pests' + (divs - 1)
            
            select = document.getElementById(pse);
            
            
            
            opText = '';
            i = 0;
            for (i = 0; i <= chemstring.length - 1; i++) {
                
                if (chemstring[i] != "") {
                    
                    //var ChemName = chemstring[i].split('!');
                    var chem = chemstring[i];
                    var val = chemstring[i];
                    //var elOptNew = document.createElement('option');
                    //elOptNew.text = chem;
                    //elOptNew.value = val;
                    
                    if (chem.indexOf("*") != -1) {
                        opText += '<option value="' + val.replace("*", "") + '" selected>' + chem.replace("*", "") + '</ option>';
                        
                    }
                    else {
                        opText += '<option value="' + val + '">' + chem + '</ option>';
                    }
                }
            }
            
            
            
            
            
            htmlstr = '<select id="dPests' + (divs - 1) + '" style="width:130px" MULTIPLE >' +
            opText +
            '</select>';
            
            select.innerHTML = htmlstr;
            
            //********************************************************************
            chemstring = detailstring[2].split(",");
            
            pse = 'site' + (divs - 1)
            
            select = document.getElementById(pse);
            
            
            
            opText = '';
            i = 0;
            for (i = 0; i <= chemstring.length - 1; i++) {
                
                if (chemstring[i] != "") {
                    
                    // var ChemName = chemstring[i].split('*');
                    var chem = chemstring[i];
                    var val = chemstring[i];
                    //var elOptNew = document.createElement('option');
                    //elOptNew.text = chem;
                    //elOptNew.value = val;
                    if (i == 0) {
                        opText += '<option value="' + val + '" selected>' + chem + '</ option>';
                    }
                    else {
                        opText += '<option value="' + val + '">' + chem + '</ option>';
                    }
                    
                }
            }
            
            
            
            
            
            htmlstr = '<select id="dSite' + (divs - 1) + '" style="width:130px" MULTIPLE >' +
            opText +
            '</select>';
            
            select.innerHTML = htmlstr;
            
            //********************************************************************
            
            /*     var arr = detailstring[2].split(",")
             chemstring = arr[0].split("*")[1].split("|");
             
             pse = 'sitedetail' + (divs - 1)
             
             select = document.getElementById(pse);
             
             
             
             opText = '';
             i = 0;
             for (i = 0; i <= chemstring.length - 1; i++) {
             
             if (chemstring[i] != "") {
             
             var ChemName = chemstring[i].split('*');
             var chem = ChemName[0];
             var val = ChemName[1];
             //var elOptNew = document.createElement('option');
             //elOptNew.text = chem;
             //elOptNew.value = val;
             
             opText += '<option value="' + val + '">' + chem + '</ option>';
             }
             }
             
             
             
             
             
             htmlstr = '<select id="dSiteDetail' + (divs - 1) + '" style="width: 72px" >' +
             opText +
             '</select>';
             
             select.innerHTML = htmlstr;
             */
            
            
            if (defaults == true) {
                divs -= 1;
            }
        }
        
        function test23() {
            chemical1.innerHTML = '<select id="test22" onchange="alert(\'test\')" > <option>test</option><option>test1</option></select>';
            
        }
        
        
        function acctnum() {
            
            document.getElementById('AccountNumber').value = queryString('accountnumber');
            document.getElementById('Route_Id').value = queryString('routestopid');
            document.getElementById('hr_emp_id').value = queryString('hr_emp_id');
            document.getElementById('servicetypecode').value = queryString('servicetypecode');
            document.getElementById('CustomerName').value = queryString('CustomerName');
            document.getElementById('Address').value = queryString('Address');
            document.getElementById('CityState').value = queryString('CityState');
            document.getElementById('Phone1').value = queryString('Phone1');
            document.getElementById('PrevBal').value = queryString('PrevBal');
            document.getElementById('Charge').value = queryString('Charge');
            
            document.getElementById('licNumber').value = queryString('licnum');
            document.getElementById('techname').value = queryString('techname');
            document.getElementById('office1').value = queryString('office');
            document.getElementById('TimeIn').value = queryString('timein');
            document.getElementById('workorderitem_id').value = queryString('workorderitem_id');
            //gps();
            
        }
        
        
        function gps() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, gpserror);
            }
            else {
                //alert("Geolocation is not supported by this browser.");
            }
        }
        function showPosition(pos) {
            
            // alert("Latitude: " + pos.coords.latitude + "\nLongitude: " + pos.coords.longitude + "\nAccuracy: " + pos.coords.accuracy);
            document.getElementById('lat').value = pos.coords.latitude;
            document.getElementById('lon').value = pos.coords.longitude;
            document.getElementById('accuracy').value = pos.coords.accuracy;
            
            
        }
        function gpserror() {
            alert("Customer GPS is used for route optomization Clicking Dont Allow Will effect the quality of your routes");
        }
        
        
            </script>
        
    </head>
    
    
    <body bgcolor="white">
        <input type="hidden" id="licNumber" />
        <input type="hidden" id="techname" />
        <input type="hidden" id="AccountNumber" />
        <input type="hidden" id="Route_Id" />
        <input type="hidden" id="hr_emp_id" />
        <input type="hidden" id="servicetypecode" />
        <input type="hidden" id="CustomerName" />
        <input type="hidden" id="Address" />
        <input type="hidden" id="CityState" />
        <input type="hidden" id="Phone1" />
        <input type="hidden" id="PrevBal" />
        <input type="hidden" id="Charge" />
        <input type="hidden" id="office1" />
        <input type="hidden" id="lat" />
        <input type="hidden" id="lon" />
        <input type="hidden" id="accuracy" />
        <input type="hidden" id="workorderitem_id" />
        
        <input id="Check" type="hidden" size="6" name="Check" />
        <input id="paymentamount" type="hidden" size="6" name="Amount" />
        
        <div style="background-color:#660000;color:white;padding:4px;">
            <b>Service Results<o:p></o:p></b> </div><div style="background-color:white;color:black;padding:4px;">
                Result:
                <select id="Result" name="ResultSelect" style="position:absolute; left:70px;">
                    <option value="Serviced">Serviced</option>
                    <option value="MissedD">Missed Dogs</option>
                    <option value="MissedLG">Missed Locked Gate</option>
                    <option value="MissedNH">Missed Not Home</option>
                    <option value="MissedNPNS">Missed NPNS</option>
                    <option value="MissedOffice">Missed Office</option>
                    <option value="MissedO">Missed Other</option>
                </select><br /><br />
                <b>Invoice:</b> <input type="number" id="Invoice" size="15" style="position:absolute; left:70px; width:60px;" />
                
                <b style="position:absolute; left:155px">Time In:</b>
                <input id="TimeIn" type="text" size="15" style="position:absolute; left:230px; width:60px;" /><br/>
            </div><br/>
            <div style="background-color: #006699; color: white; padding: 4px;">
                <b>Payments:</b> </div> <div style="background-color:white;color:black;padding:4px;">
                    <br />
                    Use the payment button on the previous page for payments
                    <br/>
                    <select id="paymenttype" name="PaymentType" style="visibility:hidden; position:absolute; right:6px;" )=)>
                        <option></option>
                        <option value="Cash">Cash</option>
                        <option value="Check">Check</option>
                    </select>
                    <br/>
                </div>
                
                
                <div style="background-color: #006699; color: white; padding: 4px;">
                    <b>Comments:</b> </div>
                <div style="background-color:white;color:black;padding:4px;">
                    <br />
                    
                    <textarea id="Comments" name="Comments" style="position:absolute; width:94%; left:3%; height:100px;"></textarea>
                    <br /><br /><br /><br /><br /><br />
                    <div style="background-color: #006699;color:white;padding:4px;">   <b>Chemicals:</b>   </div>
                </div >
                <div id="div1"style="padding: 10px; overflow: scroll; height: 375px; -webkit-overflow-scrolling: touch;">
                    <div id="chemical1" style="padding:4px;">
                    </div>
                    <div id="chemical2" style="padding:4px;">
                    </div>
                    <div id="chemical3" style="padding:4px;">
                    </div>
                    <div id="chemical4" style="padding:4px;">
                    </div>
                    <div id="chemical5" style="padding:4px;">
                    </div>
                    <div id="chemical6" style="padding:4px;">
                    </div>
                    <div id="chemical7" style="padding:4px;">
                    </div>
                    <div id="chemical8" style="padding:4px;">
                    </div>
                    <br/>
                    <br/>
                    <br/>
                    <br />
                </div>
                <!--<div style="position:absolute;height:200%;"></div>--->
                
                
                <div id="Button1" class="demo-pricing demo-pricing-1" onclick="makeChemicalObj()" style="position:absolute;top:850px;padding: 8px; left: 8px; width: 44%; height:25px;border-style: none;font-size:150%;">Add Chemicals</div>
                
                <div id="Button2" class="demo-pricing demo-pricing-1" style="position: absolute;top:850px; padding: 8px; border-style: none; right: 1px; width: 44%; height: 25px; font-size: 150%; " onclick="defaultchem()">Defaults</div>
                
                
                
                <div class="demo-pricing demo-pricing-1" id="printButton" style="position: absolute;top:900px; padding: 8px; border-style: none; bottom: 5px; left: 8px; height: 25px; width: 44%; font-size: 150%; " onclick="return addSimpleEmailAddresses()">Print Ticket</div>
                
                <div class="demo-pricing demo-pricing-1" id="sendButton" style="position: absolute; top:900px;padding: 8px; border-style: none; bottom: 5px; height: 25px; right: 1px; width: 44%; font-size: 150%; " onclick="return addSimpleEmailAddressesSend()">Send Results</div><br /><br />
                <script language="javascript" type="text/javascript">
                    
                    acctnum();
                    testConnection();
                    </script>
    </body>
    
</html>
